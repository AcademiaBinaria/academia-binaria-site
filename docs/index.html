<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Academia Binaria</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Artículos y tutoriales sobre Angular, NodeJs, MongoDB y todo lo relacionado con JavaScript y TypeScript">
<meta property="og:type" content="website">
<meta property="og:title" content="Academia Binaria">
<meta property="og:url" content="http://agorabinaria.com/academia-binaria-site/index.html">
<meta property="og:site_name" content="Academia Binaria">
<meta property="og:description" content="Artículos y tutoriales sobre Angular, NodeJs, MongoDB y todo lo relacionado con JavaScript y TypeScript">
<meta property="og:locale" content="es">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Academia Binaria">
<meta name="twitter:description" content="Artículos y tutoriales sobre Angular, NodeJs, MongoDB y todo lo relacionado con JavaScript y TypeScript">
  
    <link rel="alternate" href="/atom.xml" title="Academia Binaria" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/academia-binaria-site/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/academia-binaria-site/" id="logo">Academia Binaria</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/academia-binaria-site/" id="subtitle">Formación en enspañol para programadores</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/academia-binaria-site/">Home</a>
        
          <a class="main-nav-link" href="/academia-binaria-site/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://agorabinaria.com/academia-binaria-site"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/uncategorized/hello-world/" class="article-date">
  <time datetime="2017-10-25T15:01:20.000Z" itemprop="datePublished">2017-10-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/uncategorized/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/uncategorized/hello-world/" data-id="cj976ek270012q4jshgmt34sb" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-typescript-programa-en-el-front-igual-que-en-el-back" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Opinion/typescript-programa-en-el-front-igual-que-en-el-back/" class="article-date">
  <time datetime="2017-03-14T18:02:11.000Z" itemprop="datePublished">2017-03-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Opinion/">Opinión</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Opinion/typescript-programa-en-el-front-igual-que-en-el-back/">TypeScript, programa en el front igual que en el back</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Hasta hace bien poco había dos mundos en la programación casi enfrentados: el desarrollo <em>back end y el front end</em>. El primero era el de los programadores de verdad, con <strong>lenguajes serios y patrones de diseño</strong>. El último era el universo de los diseñadores, con lenguajes de segundo nivel y <strong>micro scripts o código espagueti</strong> descontrolado.</p>
<p>Pero la llegada de los frameworks <em>MVC</em> en el cliente, llevó <strong>grandes cantidades de código al navegador</strong> y el desarrollo front end ya nunca sería lo mismo. Primero se portaron los patrones, después las buenas prácticas, más tarde las herramientas y así hasta haber eliminado las fronteras entre <em>back y front</em>.</p>
<p>Pero quedaba algo pendiente, el leguaje. En el lado del servidor había multitud de opciones, siendo <em>Java</em> y <em>C#</em> las más aceptadas por la empresa, administración y banca. Pero al otro lado del cable seguía, con algunos retoques, el viejo <em>JavaScript</em>.</p>
<p>Y entonces eclosionó <em>TypeScript</em>. Un proyecto maduro creado por el equipo de desarrollo de Microsoft y que lleva a <em>JavaScript</em> al siguiente nivel. Con <strong>tipos estáticos</strong> (de ahí su nombre) propicia que las herramientas de desarrollo mejoren la productividad y experiencia de los programadores. Y como consecuencia <strong>suaviza la rampa de entrada al <em>front</em> para los desarrolladores <em>back</em></strong>.</p>
<p>Ya no queda excusas para programar en el cliente igual de bien que en el servidor. Prueba el <em>TypeScript</em> si dominas y te gusta la POO, serás un <em>full stack</em> cuestión de horas.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Opinion/typescript-programa-en-el-front-igual-que-en-el-back/" data-id="cj976gty3002qq4jsnad1yu8j" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/TypeScript/">TypeScript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-codigo-de-ejemplo-curso-de-angular2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Introduccion/codigo-de-ejemplo-curso-de-angular2/" class="article-date">
  <time datetime="2016-09-21T06:37:13.000Z" itemprop="datePublished">2016-09-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Introduccion/codigo-de-ejemplo-curso-de-angular2/">Código de ejemplo curso de Angular2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Enlace a los repositorios con el código de ejemplo para los cursos de <strong>Angular2</strong> :</p>
<h3 id="2-0-cli"><a href="#2-0-cli" class="headerlink" title="2.0 cli"></a>2.0 cli</h3><p><a href="https://github.com/AcademiaBinaria/angular2" target="_blank" rel="external">AcademiaBinaria/angular2</a></p>
<p>Este proyecto es un <em>work in progress</em>.</p>
<p>Está basado en el generador <a href="https://github.com/angular/angular-cli" target="_blank" rel="external">Angular-CLI</a>, el más adecuado para aplicaciones reales </p>
<h3 id="RC6-Seed"><a href="#RC6-Seed" class="headerlink" title="RC6 Seed"></a>RC6 Seed</h3><p><a href="https://github.com/AcademiaBinaria/angular2-RC6" target="_blank" rel="external">AcademiaBinaria/angular2-RC6</a></p>
<p>Aunque es para la <code>RC6</code> el código es perfectamente <em>compatible con la versión estable</em>.</p>
<p>Está basado en el proyecto <a href="https://github.com/angular/angular2-seed" target="_blank" rel="external">Angular2-Seed</a>, que es más sencillo que el CLI para empezar. </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Introduccion/codigo-de-ejemplo-curso-de-angular2/" data-id="cj976gty9002wq4jsnyco933l" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-formularios-de-datos-en-angular2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Introduccion/formularios-de-datos-en-angular2/" class="article-date">
  <time datetime="2016-06-22T14:32:34.000Z" itemprop="datePublished">2016-06-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Introduccion/formularios-de-datos-en-angular2/">Formularios de datos en Angular2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Los formularios en AngularJS fueron un éxito inicial debido entre otras coas al <em>double binding</em>. Otra cosa que no fue nunca simple es la <strong>validación de controles en los formualrios</strong>. En Angular 2 y con la última versión RC3 la cosa mejora, pero es aún un <em>Work in progress.</em></p>
<h3 id="Dependencias"><a href="#Dependencias" class="headerlink" title="Dependencias"></a>Dependencias</h3><p>Con el lío de versiones de los últimos días, conviene que os muestre con qué he hecho mi prueba.<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">"dependencies": &#123;</div><div class="line">    "@angular/common": "2.0.0-rc.3",</div><div class="line">    "@angular/compiler": "2.0.0-rc.3",</div><div class="line">    "@angular/core": "2.0.0-rc.3",</div><div class="line">    "@angular/forms": "^0.1.1",</div><div class="line">    "@angular/http": "2.0.0-rc.3",</div><div class="line">    "@angular/platform-browser": "2.0.0-rc.3",</div><div class="line">    "@angular/platform-browser-dynamic": "2.0.0-rc.3",</div><div class="line">    "@angular/router": "3.0.0-alpha.7",</div><div class="line">    "es6-shim": "^0.35.0",</div><div class="line">    "reflect-metadata": "0.1.3",</div><div class="line">    "rxjs": "5.0.0-beta.6",</div><div class="line">    "systemjs": "0.19.26",</div><div class="line">    "zone.js": "^0.6.12"</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<p>Como veis están actualizadas a la <code>RC.3</code> y <code>forms 0.1.1</code>.</p>
<blockquote>
<p>Si usas <strong>SystemJS</strong>, acuérdate de incluir <code>@angular/forms</code> en el fichero <code>system-config.json</code></p>
</blockquote>
<p>En el <code>main.ts</code> debemos registrar los <em>providers</em> que permiten la convivencia de la actual versión de <em>forms</em> y la anterior (de la semana pasada) ya obsoleta.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; disableDeprecatedForms, provideForms &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</div><div class="line">bootstrap(CashFlowAppComponent,[</div><div class="line">  disableDeprecatedForms(),</div><div class="line">  provideForms()</div><div class="line">]);</div></pre></td></tr></table></figure>
<h3 id="Plantillas-html-para-hacer-formularios"><a href="#Plantillas-html-para-hacer-formularios" class="headerlink" title="Plantillas html para hacer formularios"></a>Plantillas html para hacer formularios</h3><p>Vamos a tratar de mantener el <strong>html limpio</strong> hasta dónde sea posible. En un futuro espero que incluso sea prescindible y que se pueda generar de forma automática a partir de datos de configuración.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"formularioMovimiento"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span>Tipo:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"tipo"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngIf</span>=<span class="string">"formularioMovimiento.controls['tipo'].touched &amp;&amp; !formularioMovimiento.controls['tipo'].valid"</span>&gt;</span></div><div class="line">      Necesitamos el tipo de movimiento</div><div class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span>Categoría:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"categoria"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span>Fecha:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span> <span class="attr">formControlName</span>=<span class="string">"fecha"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span>Importe:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">formControlName</span>=<span class="string">"importe"</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngIf</span>=<span class="string">"formularioMovimiento.controls['importe'].touched &amp;&amp; !formularioMovimiento.controls['importe'].valid"</span>&gt;</span></div><div class="line">      Necesitamos el tipo de movimiento</div><div class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span> </span></div><div class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">"submit"</span> </span></div><div class="line"><span class="tag">    [<span class="attr">disabled</span>]=<span class="string">"!formularioMovimiento.valid"</span></span></div><div class="line"><span class="tag">    (<span class="attr">click</span>)=<span class="string">"guardarMovimiento()"</span> &gt;</span>Guardar</div><div class="line">  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>Se incluyen la lógica para mostrar mensajes de validación y activación del botón de guardado. He optado por no usar la definción de variables en la plantilla mediante <code>#</code>.</p>
<h3 id="Logica-y-datos-en-el-componente"><a href="#Logica-y-datos-en-el-componente" class="headerlink" title="Lógica y datos en el componente"></a>Lógica y datos en el componente</h3><p>Trataremos de llevar la <strong>lógica de generación y validación de datos</strong> al componente y programarlo en TypeScript. Puede ser por mi pasado <em>backender</em> pero me encuentro más cómodo cuanto más lejos de un lenguaje de marcas.</p>
<p>Para empezar necesitamos registrar las herramientas. El proveedor <code>FormBuilder</code> nos ayuda a definir los controles asociados al formulario y sus validaciones.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; REACTIVE_FORM_DIRECTIVES, FormBuilder, FormGroup, Validators  &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</div><div class="line">@Component(&#123;</div><div class="line">  directives: [REACTIVE_FORM_DIRECTIVES],</div><div class="line">  providers:[FormBuilder]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>En el evento <code>OnInit</code> construimos la estructura de soporte al formulario. Se puede hacer mucho más compleja, mediante la inclusión de grupos de controles anidados.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">ngOnInit() &#123;</div><div class="line">    <span class="keyword">this</span>.formularioMovimiento = <span class="keyword">this</span>.formBuilder.group(&#123;</div><div class="line">      tipo: [<span class="string">''</span>,Validators.required],</div><div class="line">      categoria: [],</div><div class="line">      fecha: [],</div><div class="line">      importe:[<span class="string">''</span>,Validators.required]</div><div class="line">    &#125;);</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>Antes de enviar datos a un serviciop se pueden hacer validaciones y ttransformacipnes previas. El acceso a los valores del formulario se hace través de su propiedad <code>.value</code>. Con esto ya realizaremos los envíos a los servicios…</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">guardarMovimiento() &#123;       </div><div class="line"> <span class="keyword">this</span>.miServicio.Guardar(<span class="keyword">this</span>.formularioMovimiento.value);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Validacion"><a href="#Validacion" class="headerlink" title="Validación"></a>Validación</h3><p>La validación temprana es el objetivo fundamental de un desarrollo de formularios. Es buena para el usuario y buena para el sistema. Angular2 facilita la implementación de las validaciones estándar y permite la creación de las tuyas propias.</p>
<p>Lo veremos en próximas entregas. Sígueme en <a href="https://twitter.com/albertobasalo" target="_blank" rel="external">mi cuenta de twitter</a> o suscríbete a la <a href="http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339" target="_blank" rel="external">revista mensual de Academia Binaria</a> y serás el primero en ser informado.</p>
<p><em>Keep coding, keep learning.</em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Introduccion/formularios-de-datos-en-angular2/" data-id="cj976gty1002oq4jsnbrracxl" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-comunicaciones-http-observables-con-angular2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Introduccion/comunicaciones-http-observables-con-angular2/" class="article-date">
  <time datetime="2016-06-16T09:47:28.000Z" itemprop="datePublished">2016-06-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Introduccion/comunicaciones-http-observables-con-angular2/">Comunicaciones http observables con Angular2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>En AngularJS, y en otros frameworks del lado cliente, la idea de fue simple desde el principio: dame <strong>plantillas estáticas y datos dinámicos</strong>. Las comunicaciones <em>http</em> son las arterias vitales de transporte de esos datos dinámicos. Y en Angular 2 se han revisado por completo, llevando las comunicaciones asíncronas al siguiente nivel.</p>
<h3 id="La-libreria-http-y-otras…"><a href="#La-libreria-http-y-otras…" class="headerlink" title="La librería http y otras…"></a>La librería http y otras…</h3><p>Como cabe esperar Angular 2 dispone de su propio módulo de comunicaciones. En la librería <code>@angular/http</code> encontramos el nuevo servicio <code>http</code> que es el cliente usado para enviar y recibir datos.</p>
<p>Lo realmente novedoso viene de parte del proyecto <a href="http://reactivex.io/rxjs/" target="_blank" rel="external">Reactive Extensions o RxJS</a>. En su librería <code>rxjs/Observable</code> exporta la clase <code>Observable</code>. Esta clase implementa el <strong>patrón observador aplicado a streams</strong> de datos. El equipo de Angular ha decidido adoptarlo para procesar los <em>streams</em> de entrada y salida de datos <em>http</em>.</p>
<p>Un servicio típico que necesite comunicaciones con el servidor importará al menos estos objetos.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Importar objetos de la librería http</span></div><div class="line"><span class="keyword">import</span> &#123; Http, Response, RequestOptions, Headers &#125; <span class="keyword">from</span> <span class="string">'@angular/http'</span>;</div><div class="line"><span class="comment">// Importar la clase Observable desde la librería rxjs</span></div><div class="line"><span class="keyword">import</span> &#123; Observable &#125;     <span class="keyword">from</span> <span class="string">'rxjs/Observable'</span>;</div></pre></td></tr></table></figure>
<p>Los servicios importados han de ser <strong>registrados como <em>providers</em> para poder ser inyectados como dependencias</strong> antes de ser consumidos. Ya que se trata de servicios de amplio uso en cualquier aplicación, se recomienda registrarlos en módulos de alto nivel. De esa forma pueden ser reutilizados como <em>singletons</em>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// importar la constante con los proveedores de http</span></div><div class="line"><span class="keyword">import</span> &#123; HttpModule, Http &#125; <span class="keyword">from</span> <span class="string">'@angular/http'</span>;</div><div class="line"></div><div class="line"><span class="meta">@NgModule</span>(&#123;</div><div class="line">  declarations: [ ],</div><div class="line">  imports: [</div><div class="line">    HttpModule, <span class="comment">// El módulo con todo lo necesario</span></div><div class="line">  ],</div><div class="line">  providers:[</div><div class="line">    Http, <span class="comment">// El servicio proveedor</span></div><div class="line">  ]</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>A partir de ese momento cualquier componente o servicio puede reclamar su inyección en el constructor, y lo podrá usar en sus propios métodos.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">* Constructor que reclama dependencias inyectables</span></div><div class="line"><span class="comment">* Http se encuentra por haberse registrado en este módulo o en uno superior</span></div><div class="line"><span class="comment">**/</span></div><div class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> http: Http</span>) &#123;</div><div class="line">   <span class="comment">// en el constructor no debe contener lógica extra</span></div><div class="line">   <span class="comment">// su función es únicamente recibir las dependencias</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Observables-en-lugar-de-promesas"><a href="#Observables-en-lugar-de-promesas" class="headerlink" title="Observables en lugar de promesas"></a>Observables en lugar de promesas</h3><p>La naturaleza asíncrona de las comunicaciones entre maquinas se implementó mediante <em>callbacks</em> en JavaScript. Esta forma de programar degenera en código difícil de mantener. Con el tiempo el <strong>patrón promesa</strong> se impuso, y en AngularJS 1.x es la manera recomendada de programar.</p>
<p>Pero las promesas también tiene sus limitaciones, y ahí aparecen los <strong>observables</strong>. Este patrón requerirá un artículo para el sólo, pero como adelanto se resume en lo siguiente:</p>
<blockquote>
<p>Tratar todo tipo de información como un stream observable de entrada y de salida, al cual se le pueden agregar operaciones que procesan los flujos de datos.</p>
</blockquote>
<p>Esto encaja muy bien con las comunicaciones <em>http</em> asíncronas y es la razón de su adopción en Angular 2. Un método de servicio par <strong>leer datos REST</strong> se parecerá a este <em>snippet</em>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// las llamadas devuelven observables</span></div><div class="line">leerDatos(): Observable&lt;Response&gt; &#123;</div><div class="line">  <span class="comment">// Se declara cómo va a ser la llamada </span></div><div class="line">  <span class="comment">// ocultando los pormenores a los consumidores   </span></div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http</div><div class="line">    .get(<span class="string">`<span class="subst">$&#123;this.urlBase&#125;</span>/recurso`</span>);</div><div class="line">  <span class="comment">// En este momento aún no se efectuó la llamada</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Para enviar información via <em>post</em> o <em>put</em> usaremos una estrategia similar, pero con unos requisitos específicos. En Angular 2 se requiere una configuración previa de las llamadas de escritura. Es engorroso pero fácilmente automatizable. Una típica operación de <strong>escritura REST</strong> sería algo así:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">escribirDatos(unDato): Observable&lt;Response&gt; &#123;</div><div class="line">  <span class="comment">// Los envíos de información deben configurarse a mano</span></div><div class="line">  <span class="comment">// esto es fácilmente generalizable y reutilizable</span></div><div class="line">  <span class="keyword">let</span> body = <span class="built_in">JSON</span>.stringify(unDato);</div><div class="line">  <span class="keyword">let</span> headers = <span class="keyword">new</span> Headers(&#123; <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span> &#125;);</div><div class="line">  <span class="keyword">let</span> options = <span class="keyword">new</span> RequestOptions(&#123; headers: headers &#125;);</div><div class="line">  <span class="comment">// declarar la llamada y retornar el observable</span></div><div class="line">  <span class="comment">// las variables de configuración y los datos, van como parámetros</span></div><div class="line">  <span class="keyword">if</span> (unDato._id) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.http</div><div class="line">      .put(<span class="string">`<span class="subst">$&#123;this.urlBase&#125;</span>/recurso/<span class="subst">$&#123;unDato._id&#125;</span>`</span>, body, options);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.http</div><div class="line">      .post(<span class="string">`<span class="subst">$&#123;this.urlBase&#125;</span>/recurso`</span>, body, options);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Por supuesto esto es lo que se programa a bajo nivel, en los <strong>servicios de comunicaciones</strong>. En Angular2 se mantiene la recomendación de bajar a servicios la responsabilidad de las comunicaciones al tiempo que dejamos los componentes lo más ligeros posible. </p>
<p>Por encima de los servicios de comunicaciones habrá otros servicios de lógica o directamente componentes. En cualquier caso, los consumidores llamarán a métodos que siempre les devolverán objetos observables. Las clases de alto nivel se <strong>suscribirán a esos observables</strong> y procesarán la respuesta recibida… cuando esta esté disponible.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// La carga de datos se hace al iniciarse el componente</span></div><div class="line"><span class="comment">// este es el lugar donde programar lógica de inicio</span></div><div class="line"><span class="comment">// nunca en el constructor</span></div><div class="line">ngOnInit() &#123;</div><div class="line">  <span class="comment">// en el momento de la suscripción es cuando se dispara la llamada</span></div><div class="line">  <span class="keyword">this</span>.datosService</div><div class="line">    .leerDatos()</div><div class="line">    .subscribe(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">this</span>.datos = res.json();</div><div class="line">    &#125;);</div><div class="line">  <span class="comment">// Sería similar en procesos de escritura</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>La clase <code>http</code> no realiza la llamada hasta que algún consumidor se suscriba a la respuesta. Mientras tanto queda como una definición congelada.</p>
</blockquote>
<p>El método <code>.subscribe()</code> recibe como argumento un puntero a la respuesta <em>http</em>. Los datos se encuentran en formato <em>JSON</em> y hay que reclamarlos mediante el método <code>.json()</code></p>
<h3 id="Extensiones-en-lugar-de-interceptores"><a href="#Extensiones-en-lugar-de-interceptores" class="headerlink" title="Extensiones en lugar de interceptores"></a>Extensiones en lugar de interceptores</h3><p>Una de las características destacables de los servicios <code>$http</code> de AngularJS 1.x era la posibilidad de usar <em>interceptores</em>. Estos eran <strong>funciones que se incrustaban durante el envío o recepción</strong> de las comunicaciones.</p>
<p>Un uso habitual era emplearlos para agregar <strong>cabeceras de seguridad o controlar errores</strong> de comunicación de manera centralizada. Ahora la forma recomendable de hacer eso mismo en Angular2 es mejorar el servicio http extendiéndolo. El servicio derivado resultante implementará los interceptores en funciones llamadas durante la comunicación.</p>
<p>Esta es una posible implementación con funcionalidad suficiente para facilitar los envíos, detectar errores y enviar cabeceras de seguridad.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Injectable</span>()</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Extensión personalizada de la clase HTTP</span></div><div class="line"><span class="comment"> * Permite la configuración de todas las peticiones</span></div><div class="line"><span class="comment"> * Captura los envíos y respuestas</span></div><div class="line"><span class="comment"> * */</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">class</span> HttpService <span class="keyword">extends</span> Http &#123;</div><div class="line">  <span class="comment">/** Las direcciones base deberían venir de la configuración del environment*/</span></div><div class="line">  <span class="keyword">public</span> apiProxyUrl = <span class="string">'http://localhost:4030/api/'</span>;</div><div class="line">  <span class="keyword">private</span> authorization = <span class="string">''</span>;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>(<span class="params"></span></div><div class="line"><span class="params">    backend: XHRBackend,</span></div><div class="line"><span class="params">    defaultOptions: RequestOptions,</span></div><div class="line"><span class="params">    <span class="keyword">private</span> router: Router,</span></div><div class="line"><span class="params">    <span class="keyword">private</span> userStore: SessionStoreService</span></div><div class="line"><span class="params">  </span>) &#123;</div><div class="line">    <span class="keyword">super</span>(backend, defaultOptions);</div><div class="line">    <span class="keyword">this</span>.subscribeToToken();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * Reescribe el método de la clase base, ejecutando acciones para cada petición</span></div><div class="line"><span class="comment">   * La peticiíón en curso puede llegar como una ruta o una clase request</span></div><div class="line"><span class="comment">   * Si viene sólo la cadena, debería traer las opciones aparte</span></div><div class="line"><span class="comment">   * */</span></div><div class="line">  request(request: <span class="built_in">string</span> | Request, options: RequestOptionsArgs = &#123; headers: <span class="keyword">new</span> Headers() &#125;): Observable&lt;Response&gt; &#123;</div><div class="line">    <span class="keyword">this</span>.configureRequest(request, options);</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.interceptResponse(request, options);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> subscribeToToken() &#123;</div><div class="line">    <span class="comment">// suponemos un servicio que nos avisa de la recepción de tokens</span></div><div class="line">    <span class="keyword">this</span>.userStore</div><div class="line">      .getDataObservable()</div><div class="line">      .subscribe(<span class="function">(<span class="params">data: Session</span>) =&gt;</span> <span class="keyword">this</span>.authorization = <span class="string">'Bearer '</span> + data.token);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> configureRequest(request: <span class="built_in">string</span> | Request, options: RequestOptionsArgs) &#123;</div><div class="line">    <span class="comment">// Adapta la ruta y asigna cabeceras</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> request === <span class="string">'string'</span>) &#123;</div><div class="line">      request = <span class="keyword">this</span>.getProxyUrl(request);</div><div class="line">      <span class="keyword">this</span>.setHeaders(options);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      request[<span class="string">'url'</span>] = <span class="keyword">this</span>.getProxyUrl(request[<span class="string">'url'</span>]);</div><div class="line">      <span class="keyword">this</span>.setHeaders(request);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> interceptResponse(request: <span class="built_in">string</span> | Request, options: RequestOptionsArgs) : Observable&lt;Response&gt; &#123;</div><div class="line">    <span class="keyword">const</span> observableRequest = <span class="keyword">super</span></div><div class="line">      .request(request, options)</div><div class="line">      .catch(<span class="keyword">this</span>.onCatch())</div><div class="line">      .finally(<span class="keyword">this</span>.onFinally());</div><div class="line">    <span class="keyword">return</span> observableRequest;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * Transforma la url para llamar a trave´s de un proxy </span></div><div class="line"><span class="comment">   * Útil en caso de problemas con el CORS</span></div><div class="line"><span class="comment">   */</span></div><div class="line">  <span class="keyword">private</span> getProxyUrl(currentUrl) &#123;</div><div class="line">    <span class="keyword">if</span> (!currentUrl.includes(<span class="string">'/assets/'</span>)) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.apiProxyUrl + currentUrl;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> currentUrl;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * Interceptor para componer las cabeceras en cada petición</span></div><div class="line"><span class="comment">   * */</span></div><div class="line">  <span class="keyword">private</span> setHeaders(objectToSetHeadersTo: Request | RequestOptionsArgs) &#123;</div><div class="line">    <span class="keyword">const</span> headers = objectToSetHeadersTo.headers;</div><div class="line">    headers.set(<span class="string">'Content-Type'</span>, <span class="string">'application/json'</span>);</div><div class="line">    headers.set(<span class="string">'Authorization'</span>, <span class="keyword">this</span>.authorization);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * Interceptor para captura genérica de errores http</span></div><div class="line"><span class="comment">   * */</span></div><div class="line">  <span class="keyword">private</span> onCatch() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">res: Response</span>) =&gt;</span> &#123;</div><div class="line">      <span class="comment">// Security errors</span></div><div class="line">      <span class="keyword">if</span> (res.status === <span class="number">401</span> || res.status === <span class="number">403</span>) &#123;</div><div class="line">        <span class="comment">// redirigir al usuario para pedir credenciales</span></div><div class="line">        <span class="keyword">this</span>.router.navigate([<span class="string">'user/login'</span>]);</div><div class="line">      &#125;</div><div class="line">      <span class="comment">// To Do: Gestión común de otros errores...</span></div><div class="line">      <span class="keyword">return</span> Observable.throw(res);</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> onFinally() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'Fin'</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Podemos usarlo de manera transparente en el resto de la aplicación. Sólo se necesita ajustar el registro de proveedores para dirigir al inyector de dependencias hacia esta nueva clase.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> providers: [</div><div class="line">  &#123;</div><div class="line">    provide: Http, <span class="comment">// reemplaza el servicio del framework</span></div><div class="line">    useClass: HttpService <span class="comment">// con la clase personalizada que lo extiende</span></div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure></p>
<blockquote>
<p>Este es uno de los usos más potentes de la inversión de control en Angular. Es el programador integrador el que decide el servicio a usar. El programador funcional declara la dependencia en los constructores de sus componentes y servicios, pero no decide la instancia concreta que recibirá.</p>
</blockquote>
<p>Angular 2 ha trastocado todo lo que hacíamos en las versiones 1.x, pero sólo en la forma. El fondo sigue siendo el mismo: <strong>el navegador envía y recibe datos en formato JSON que mezcla con plantillas estáticas</strong> para  crear HTML en la máquina local y relajar al servidor. </p>
<p>Por cierto, por ahora ni rastro del viejo <code>$resource</code>. No tardará en aparecer una versión basada en <em>streams observables</em>. Sígueme en <a href="https://twitter.com/albertobasalo" target="_blank" rel="external">mi cuenta de twitter</a> o suscríbete a la <a href="http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339" target="_blank" rel="external">revista mensual de Academia Binaria</a> y en cuanto me entere serás el primero en ser informado.</p>
<p><em>Keep coding, keep learning.</em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Introduccion/comunicaciones-http-observables-con-angular2/" data-id="cj976gty0002mq4jsy55xg5mt" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-enrutado-con-angular2-el-nuevo-spa" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Introduccion/enrutado-con-angular2-el-nuevo-spa/" class="article-date">
  <time datetime="2016-06-02T06:52:04.000Z" itemprop="datePublished">2016-06-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Introduccion/enrutado-con-angular2-el-nuevo-spa/">Enrutador de componentes con Angular2 el nuevo SPA</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Código asociado en <a href="https://github.com/AcademiaBinaria/angular2/tree/master/6-routing" target="_blank" rel="external">angular2/6-routing/</a></p>
</blockquote>
<p>La capacidad de gestionar las <strong>rutas en el cliente</strong> es una de las grandes ventajas de <em>AngularJS</em>. En la versión 1 nos ofrecían una solución demasiado simple que obligaba a usar librerías de terceros como la famosa <a href="https://github.com/angular-ui/ui-router" target="_blank" rel="external">ui-router</a>. Hemos esperado años la promesa de un nuevo <em>enrutador</em> compatible con las versiones 1 y 2. El resultado es <strong>@angular/router</strong>.</p>
<p>De todo <em>Angular2</em>, este es el componente que más ha cambiado durante la fase <em>Release Candidate</em>. Actualmente confiamos en que las pequeñas dudas se resuelvan definitivamente y podamos relajarnos creando modernos desarrollos <strong>SPA</strong>.</p>
<h2 id="Modulo-de-enrutado-en-base-a-componentes"><a href="#Modulo-de-enrutado-en-base-a-componentes" class="headerlink" title="Módulo de enrutado en base a componentes"></a>Módulo de enrutado en base a componentes</h2><p>Las aplicaciones Angular2 son <a href="http://academia-binaria.com/componentes-los-bloques-de-construccion-de-angular-2/" target="_blank" rel="external">árboles de módulos</a>. Al menos el módulo raíz <code>AppModule</code> y cuantos módulos funcionales nos hagan falta. Utilizando <code>angular-cli</code> podemos crear módulos con la capacidad de enrutado generada en… un módulo específico.  </p>
<p>A ver si desbrozamos algo este bosque de módulos.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ng <span class="keyword">new</span> mi-aplicacion --routing <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>Tanto para la raíz como para las ramas funcionales se creará un fichero. En la raíz será llamado <code>app-routing.module.ts</code> con un contenido como este: </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** Módulos de enrutado de Angular2 */</span></div><div class="line"><span class="keyword">import</span> &#123; RouterModule, Routes &#125; <span class="keyword">from</span> <span class="string">'@angular/router'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"></div><div class="line"><span class="comment">// Array con las rutas de este módulo. Ninguna funcional.</span></div><div class="line"><span class="keyword">const</span> routes: Routes = [</div><div class="line">  &#123; <span class="attr">path</span>: <span class="string">''</span>, <span class="attr">redirectTo</span>: <span class="string">''</span> &#125;,</div><div class="line">  &#123; <span class="attr">path</span>: <span class="string">'inicio'</span>, <span class="attr">redirectTo</span>: <span class="string">''</span> &#125;,</div><div class="line">  &#123; <span class="attr">path</span>: <span class="string">'**'</span>, <span class="attr">redirectTo</span>: <span class="string">''</span>, <span class="attr">pathMatch</span>: <span class="string">'full'</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line">@NgModule(&#123;</div><div class="line">  imports: [</div><div class="line">    RouterModule.forRoot(routes) <span class="comment">// configuración para el módulo raíz</span></div><div class="line">  ],</div><div class="line">  exports: [</div><div class="line">    RouterModule <span class="comment">// se importará desde el módulo padre</span></div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppRoutingModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<p>Este <strong>módulo</strong> de un único fichero sirve <strong>para definir las rutas de otro módulo padre</strong> asociado, <code>app.module.ts</code>, el cual quedará más o menos así:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// importación de módulo de enrutado asociado</span></div><div class="line"><span class="keyword">import</span> &#123; AppRoutingModule &#125; <span class="keyword">from</span> <span class="string">'./app-routing.module'</span>;</div><div class="line"><span class="comment">// importación de otros módulos de funcionalidad</span></div><div class="line"><span class="keyword">import</span> &#123; HomeModule &#125; <span class="keyword">from</span> <span class="string">'./home/home.module'</span>;</div><div class="line"><span class="comment">// decorador que define un módulo</span></div><div class="line">@NgModule(&#123;</div><div class="line">  declarations: [ AppComponent ], </div><div class="line">  imports: [</div><div class="line">    BrowserModule,</div><div class="line">    FormsModule,</div><div class="line">    HttpModule,</div><div class="line">    HomeModule, <span class="comment">// el módulo funcional para la 'página home'</span></div><div class="line">    AppRoutingModule <span class="comment">// el módulo de rutas ya configurado</span></div><div class="line">  ], </div><div class="line">  providers: [] </div><div class="line">  bootstrap: [ AppComponent ] </div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<h2 id="Modulos-funcionales"><a href="#Modulos-funcionales" class="headerlink" title="Módulos funcionales"></a>Módulos funcionales</h2><p>El módulo raíz es fundamental pero nada operativo. Toda el que sea de interés para los usuarios estará en módulos funcionales. En las aplicaciones SPA es una buena práctica crear <strong>un módulo por cada ruta</strong> principal. Incluida la página home. Por ejemplo usando el siguiente comando:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ng generate <span class="built_in">module</span> home --routing <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>Aparece un fichero llamado <code>home-routing-module.ts</code>. Este módulo se debe configurar para que gestione sus propias rutas.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Routes, RouterModule &#125; <span class="keyword">from</span> <span class="string">'@angular/router'</span>;</div><div class="line"><span class="comment">/** Componente enrutable */</span></div><div class="line"><span class="keyword">import</span> &#123; HomeComponent &#125; <span class="keyword">from</span> <span class="string">'./home.component'</span>;</div><div class="line"><span class="comment">/** Rutas asociadas a componentes */</span></div><div class="line"><span class="keyword">const</span> routes: Routes = [</div><div class="line">  &#123; <span class="attr">path</span>: <span class="string">''</span>, <span class="attr">component</span>: HomeComponent &#125;,</div><div class="line">];</div><div class="line"><span class="comment">/** array de componentes enrutables */</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> routableComponents = [</div><div class="line">  HomeComponent</div><div class="line">];</div><div class="line">@NgModule(&#123;</div><div class="line">  imports: [</div><div class="line">    RouterModule.forChild(routes) <span class="comment">// Para módulo funcional</span></div><div class="line">  ],</div><div class="line">  exports: [</div><div class="line">    RouterModule <span class="comment">// listo para importarlo en HomeModule</span></div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeRoutingModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<p>Se crean dos arrays relacionados. EL principal, <code>routes</code>, contendrá las <strong>rutas pareadas con sus componentes</strong> respectivos.<br>Los cuales también se exportan directamente en la variable <code>routableComponents</code>. Esto se hace por comodidad. Para no tener que volver a importarlos en la declaración del módulo padre, que quedará así:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; CommonModule &#125; <span class="keyword">from</span> <span class="string">'@angular/common'</span>;</div><div class="line"><span class="comment">/** Importación de las rutas y sus componentes */</span></div><div class="line"><span class="keyword">import</span> &#123; HomeRoutingModule, routableComponents &#125; <span class="keyword">from</span> <span class="string">'./home-routing.module'</span>;</div><div class="line">@NgModule(&#123;</div><div class="line">  imports: [</div><div class="line">    CommonModule,</div><div class="line">    HomeRoutingModule <span class="comment">// el módulo que sabe enrutar</span></div><div class="line">  ],</div><div class="line">  declarations: [</div><div class="line">    routableComponents <span class="comment">// los componentes de enrutado</span></div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<h3 id="Carga-de-componentes-segun-la-ruta"><a href="#Carga-de-componentes-segun-la-ruta" class="headerlink" title="Carga de componentes según la ruta"></a>Carga de componentes según la ruta</h3><p>Todo este trabajo de configuración se materializa en las <strong>vistas</strong>. Necesitaremos un lugar dónde inyectar el <strong>componente de turno asociado a la ruta</strong> actual. Presentamos el <code>router-outlet</code>. Y para que la aplicación pueda llevarnos de un lugar a otro usaremos  la directiva <code>routerLink</code>. </p>
<p>De forma que la plantilla raíz <code>app.component.html</code> quedará normalmente así:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--menú de navegación, sin href--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">nav</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">"['/']"</span>&gt;</span>Inicio<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">"['/login']"</span>&gt;</span>Log In<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">"['/contacto']"</span>&gt;</span>Contacto<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--Este componente nativo hace que el enrutador cargue una página dinámicamente--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="Rutas-hijas-y-con-parametros"><a href="#Rutas-hijas-y-con-parametros" class="headerlink" title="Rutas hijas y con parámetros"></a>Rutas hijas y con parámetros</h2><p>De poco vale un enrutador que sólo atienda a los casos sencillos. Las aplicaciones profesionales plantean mayores retos. </p>
<h3 id="Rutas-hijas"><a href="#Rutas-hijas" class="headerlink" title="Rutas hijas"></a>Rutas hijas</h3><p>Un ejemplo son las <strong>rutas anidadas</strong>, aquí llamadas rutas hijas. Son aquellas en las que una parte de la visualización es común y otra depende de la ruta concreta.</p>
<p>Veamos un ejemplo dónde se pretende dar de alta y mostrar una lista de elementos. La base de cualquier <em>CRUD</em>. Así quedaría el fichero <code>movimientos-routing.module.ts</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** Importación de los componentes enrutables */</span></div><div class="line"><span class="keyword">import</span> &#123; MovimientosComponent &#125; <span class="keyword">from</span> <span class="string">'./movimientos.component'</span>;</div><div class="line"><span class="keyword">import</span> &#123; ListaComponent &#125; <span class="keyword">from</span> <span class="string">'./lista/lista.component'</span>;</div><div class="line"><span class="keyword">import</span> &#123; NuevoComponent &#125; <span class="keyword">from</span> <span class="string">'./nuevo/nuevo.component'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> routes: Routes = [</div><div class="line">  &#123;</div><div class="line">    path: <span class="string">'movimientos'</span>,</div><div class="line">    component: MovimientosComponent,</div><div class="line">    children: [ <span class="comment">// rutas hijas, se verán dentro del componente padre</span></div><div class="line">      &#123;</div><div class="line">        path: <span class="string">'nuevo'</span>, <span class="comment">// la ruta real es movimientos/nuevo</span></div><div class="line">        component: NuevoComponent</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        path: <span class="string">'lista'</span>,</div><div class="line">        component: ListaComponent</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">];</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> routableComponents = [</div><div class="line">  NuevoComponent,</div><div class="line">  ListaComponent,</div><div class="line">  MovimientosComponent</div><div class="line">]</div></pre></td></tr></table></figure>
<p>Este mini-módulo es muy denso. Contrasta con la simplicidad del <code>movimientos.module.ts</code> que reduce su responsabilidad. Sólo tiene que importar los módulos adecuados.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; FormsModule &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</div><div class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; CommonModule &#125; <span class="keyword">from</span> <span class="string">'@angular/common'</span>;</div><div class="line"><span class="comment">/** Módulo de enrutado y componentes */</span></div><div class="line"><span class="keyword">import</span> &#123; MovimientosRoutingModule, routableComponents &#125; <span class="keyword">from</span> <span class="string">'./movimientos-routing.module'</span>;</div><div class="line"></div><div class="line">@NgModule(&#123;</div><div class="line">  imports: [</div><div class="line">    CommonModule,</div><div class="line">    FormsModule,</div><div class="line">    MovimientosRoutingModule</div><div class="line">  ], <span class="comment">// dependencias de otros módulos, especialmente el de enrutado</span></div><div class="line">  declarations: [</div><div class="line">    routableComponents</div><div class="line">  ], <span class="comment">// Los componentes vienen del fichero movimientos-routing.module.ts</span></div><div class="line">  exports: [</div><div class="line"></div><div class="line">  ], <span class="comment">// no necesita exportar nada</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Vemos que la idea es que los ficheros de definición de módulos funcionales <strong>deleguen toda la lógica</strong> posible a su propio módulo de enrutado.</p>
<p>Mientras tanto en la vista… Habíamos dejado la <em>template</em> del componente raíz con un <code>router-outlet</code>. Será ahí dónde se cargue el <code>MovimientosComponent</code> cuando se active la ruta <em>‘/movimientos’</em>. Pero, ¿y las rutas hijas?, ¿qué se carga y dónde se carga cuando se activa la ruta <em>‘/movimientos/nuevo’</em> o la ruta <em>‘/movimientos/lista’</em> ?.</p>
<p>Echemos un vistazo a <code>movimientos.component.html</code> para comprobar que dispone de su propio <code>router-outlet</code>. </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">nav</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/movimientos/nuevo"</span> &gt;</span>Nuevo Movimiento<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"/movimientos/lista"</span> &gt;</span>Lista de Movimientos<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Será en este elemento donde se inyecten los componentes asociados a las rutas hijas. Este <em>anidamiento</em> permite hacer aplicaciones modulares y acceder a vistas específicas con rutas específicas. </p>
<h3 id="Rutas-con-parametros"><a href="#Rutas-con-parametros" class="headerlink" title="Rutas con parámetros"></a>Rutas con parámetros</h3><p>Hasta ahora usé rutas fijas para navegar. Lo más normal es que estas <strong>plantillas contengan segmentos variables</strong> llamados parámetros. Para incorporar parámetros a tu esquema de rutas tienes que actuar en tres fases:</p>
<h4 id="1-Definir-la-parte-parametrica-de-la-plantilla-generadora-de-rutas"><a href="#1-Definir-la-parte-parametrica-de-la-plantilla-generadora-de-rutas" class="headerlink" title="1- Definir la parte paramétrica de la plantilla generadora de rutas"></a>1- Definir la parte paramétrica de la plantilla generadora de rutas</h4><p>El <em>path</em> del objeto ruta se convierte en una plantilla que admite distintos valores. Así queda ahora el módulo enrutador de movimientos:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> routes: Routes = [</div><div class="line">  &#123;</div><div class="line">    path: <span class="string">'movimientos'</span>,</div><div class="line">    component: MovimientosComponent,</div><div class="line">    children: [ <span class="comment">// rutas hijas, se verán dentro del componente padre</span></div><div class="line">      &#123;</div><div class="line">        path: <span class="string">'nuevo'</span>, <span class="comment">// la ruta real es movimientos/nuevo</span></div><div class="line">        component: NuevoComponent</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        path: <span class="string">'lista'</span>,</div><div class="line">        component: ListaComponent</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    path: <span class="string">'movimientos/:id'</span>, <span class="comment">// parámetro variable id    </span></div><div class="line">    component: EditorComponent</div><div class="line">  &#125;</div><div class="line">];</div></pre></td></tr></table></figure>
<p>Los parámetros se prefijan con <code>:</code> y en cada ruta se pueden usar tantos como sea necesario. </p>
<blockquote>
<p>Obsérvese que en este caso la ruta ‘movimientos/:id’ es hermana, no hija, de la primera. Por tanto se mostrará en el <code>router-outlet</code> del componente raíz. Se ha hecho así para mostrar distintas maneras de trabajar en el ‘router’.</p>
</blockquote>
<h4 id="2-Montar-los-enlaces-asignando-valores-a-los-parametros"><a href="#2-Montar-los-enlaces-asignando-valores-a-los-parametros" class="headerlink" title="2- Montar los enlaces asignando valores a los parámetros"></a>2- Montar los enlaces asignando valores a los parámetros</h4><p>Esto se puede hacer en las plantillas HTML o en por código. Siempre usando el <strong>array de <code>routerLink</code></strong> sin necesidad de concatenar cadenas para para montar rutas. Este array en su segunda posición llevará un objeto que represente los valores de los parámetros. </p>
<p>En un caso de navegación por código sencillo tendrá esta pinta:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// para ir a la ruta /movimientos/42</span></div><div class="line"><span class="keyword">this</span>.router.navigate([<span class="string">'movimientos'</span>, <span class="number">42</span>])</div></pre></td></tr></table></figure></p>
<p>Usando desde la vista en igual de sencillo con la directiva <code>routerLink</code>, como en este ejemplo HTML:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">"['/movimientos', 42 ]"</span>&gt;</span>42<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="3-Recuperar-los-valores-de-los-parametros-a-partir-de-las-rutas"><a href="#3-Recuperar-los-valores-de-los-parametros-a-partir-de-las-rutas" class="headerlink" title="3- Recuperar los valores de los parámetros a partir de las rutas"></a>3- Recuperar los valores de los parámetros a partir de las rutas</h4><p>La novedad más llamativa es la presencia de <code>OnInit</code>. Es un <em>hook</em>, o evento de la vida de un componente. Este evento se ejecuta al iniciarse el componente pero cuando ya la ruta se ha resuelto completamente.<br>En ese momento puedes usar <code>ActivatedRoute</code>, un servicio que entre otras cosas te dará acceso a un <em>observable</em> que emite los valores actuales de los parámetros.<br>Por ejemplo, esto sería el código del componente <code>editor.component.ts</code> que se activa con rutas como <em>‘/movimientos/42’</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component, OnInit &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="comment">/** Servicio para acceder a la ruta activa */</span></div><div class="line"><span class="keyword">import</span> &#123; ActivatedRoute &#125; <span class="keyword">from</span> <span class="string">'@angular/router'</span>;</div><div class="line"><span class="keyword">import</span> &#123; DatosService &#125; <span class="keyword">from</span> <span class="string">'./../datos.service'</span>;</div><div class="line">@Component(&#123;</div><div class="line">  selector: <span class="string">'app-editor'</span>,</div><div class="line">  templateUrl: <span class="string">'./editor.component.html'</span>,</div><div class="line">  styleUrls: [<span class="string">'./editor.component.css'</span>]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">EditorComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</div><div class="line">  public movimiento;</div><div class="line">  <span class="keyword">constructor</span>(</div><div class="line">      private route: ActivatedRoute, </div><div class="line">      private datosService: DatosService) &#123; </div><div class="line">      <span class="comment">// constructor vacío. sólo se usa para reclamar dependencias         </span></div><div class="line">  &#125;</div><div class="line">  ngOnInit() &#123;</div><div class="line">    <span class="comment">// subscripción al observable params</span></div><div class="line">    <span class="keyword">this</span>.route.params</div><div class="line">      .subscribe(<span class="function"><span class="params">params</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">const</span> _id = params[<span class="string">'id'</span>].toString();</div><div class="line">        <span class="keyword">this</span>.movimiento = <span class="keyword">this</span>.datosService.getMovimientoBy_Id(_id);</div><div class="line">      &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>Hay una estrategia opcional que emplea <code>Observables</code> para mantener potenciales cambios de estado en los valores de los parámetros. Si te interesa busca información sobre <code>Router</code> .</p>
</blockquote>
<h3 id="Carga-diferida"><a href="#Carga-diferida" class="headerlink" title="Carga diferida"></a>Carga diferida</h3><p>Esta es la funcionalidad más esperada y que sigue siendo un <em>work in progress</em>. Cuando las aplicaciones AngularJS crecen en funcionalidad producen un <strong>impacto negativo en la primera vista</strong> de un usuario. Eso es debido a que <em>Angular</em> necesita disponer de todo tu código para montar el armazón de dependencias. Esto es así aunque el usuario no vaya a navegar mas que por un conjunto reducido de rutas.</p>
<p>En aplicaciones de <em>intranet</em> o de uso muy intensivo esto no suele ser un gran problema. Esa espera inicial de unos pocos segundos se recupera durante el uso continuado de la aplicación. Pero ciertos desarrollos realmente grandes o, sobre todo, <strong>aplicaciones web públicas para usuarios ocasionales</strong> necesitaban un tratamiento especial.</p>
<p>La solución es implementar un modelo de <em>lazy loading</em> o carga diferida. En este caso el navegador descarga el HTML y el código de la aplicación según el usuario navegue. </p>
<p>En <em>Angular2</em> se incluye esta funcionalidad, pero a día de hoy aún no está disponible con <code>angular-cli</code>. Se puede <em>tunear WebPack</em> a mano para conseguirlo, pero, si no hay urgencia en salir a producción, no te lo recomiendo. Es preferible esperar un poco y usar el la solución definitiva que implemente la herramienta.</p>
<p>En cuanto sea <em>usable</em> actualizaré este artículo y difundiré la buena nueva a los cuatro vientos. Como sabes aún estamos esperando la primera <em>Release Candidate</em> de <code>angular-cli</code> y habrá mejoras importantes. </p>
<p>Mantente a la última recibiendo el <a href="http://academia-binaria.us4.list-manage.com/subscribe?u=c8ad2d2e7d02c26e32ce4cded&amp;id=b67e4d2339" target="_blank" rel="external">boletín de noticias de Academia Binaria</a> o siguiéndome en las <a href="https://twitter.com/albertobasalo" target="_blank" rel="external">redes sociales</a>. </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Introduccion/enrutado-con-angular2-el-nuevo-spa/" data-id="cj976gtxu002gq4js9bd0gxh0" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-angular2-di-inyeccion-de-dependencias" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Introduccion/angular2-di-inyeccion-de-dependencias/" class="article-date">
  <time datetime="2016-05-30T09:09:09.000Z" itemprop="datePublished">2016-05-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Introduccion/angular2-di-inyeccion-de-dependencias/">Angular2 DI: Inyección de dependencias</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Código asociado en <a href="https://github.com/AcademiaBinaria/angular2/tree/master/4-injection" target="_blank" rel="external">angular2/4-injection/</a></p>
</blockquote>
<p>AngularJS2 tiene vocación de <em>framework</em> para grandes aplicaciones de negocio. Los grandes desarrollos requieren <strong>modularidad en el código</strong>. En AngularJS se resuelve mediante la Inyección de Dependencias, siguiendo el conocido patrón <em><a href="https://es.wikipedia.org/wiki/Inyecci%C3%B3n_de_dependencias" target="_blank" rel="external">Dependency Injection</a></em>. </p>
<p>Los cambios en la versión 2 son sobre todo sintácticos, pero también conceptuales. Se mantiene el mismo objetivo, permitir hacer <strong>aplicaciones de negocio con HTML y JavaScript</strong> de manera controlable.</p>
<h2 id="Modulos-componentes-y-servicios"><a href="#Modulos-componentes-y-servicios" class="headerlink" title="Módulos, componentes y servicios"></a>Módulos, componentes y servicios</h2><p>En AngularJS 1 teníamos muy presente el concepto de <strong>módulo</strong>. Rara era la aplicación que no comenzase con el mítico <code>angular.module(&#39;miAplicacion&#39;)</code>. Dada la carencia de un sistema modular nativo en <em>JavaScript</em>, AngularJS nos proveía de uno propio. </p>
<p>Hoy en día se nos sugiere que usemos las versiones avanzadas de <em>JS</em>, o mejor aún <em>TypeScript</em>. Estos lenguajes nos ofrecen las instrucciones <code>export</code> e <code>import</code> que permiten definir <strong>módulos estancos en ficheros</strong> independientes. Nunca más el engorroso envolvimiento <em>IIFE</em> <code>(function () { … }())</code>.</p>
<p>A partir de ahí es el programador el que selectivamente <strong>exporta funcionalidad que importará para ser consumida</strong> mas tarde. De este modo, Angular se desentiende de la creación de módulos de código y se centra en la comunicación entre los objetos que componen la aplicación.</p>
<h3 id="Componentes"><a href="#Componentes" class="headerlink" title="Componentes"></a>Componentes</h3><p>Son los bloques de construcción agrupables en compuestos que forman la interfaz visual de una aplicación. Encapsulan <strong>la vista, los datos y la lógica</strong> para interactuar con el usuario. </p>
<p>Ni la vista ni la lógica deben crecer y realizar tareas que no sean de su exclusiva capa de responsabilidad. Esas tareas debe ser delegadas en otros objetos. </p>
<blockquote>
<p>Modelo de composición de componentes visuales para crear vistas complejas. La comunicación o <a href="../databinding-el-flujo-de-datos-de-angular2/">Data Flow</a> se realiza de manera declarativa. Enviando datos a las propiedades de los hijos y esperando eventos con respuestas.</p>
</blockquote>
<p><img src="/images/ng2-Component-DataFlow.jpg" alt="Composición mediante componentes"></p>
<h3 id="Servicios"><a href="#Servicios" class="headerlink" title="Servicios"></a>Servicios</h3><p>Los servicios serán <strong>objetos especializados y reutilizables</strong> por otros servicios y componentes. En su definición debes aplicar los mismos principios de arquitectura de software que ya conoces y aplicas en <em>lenguajes clásicos tipo Java o C#.net</em>.</p>
<p>La sintaxis de la comunicación involucra varios bloques en ambos lados del canal: </p>
<ul>
<li>la definición del servicio decorado como <code>@Injectable()</code> en el proveedor, </li>
<li>la exportación en el proveedor y la importación en el consumidor, </li>
<li>el registro en el array <code>providers:[]</code> del componente consumidor (o mejor del módulo) conumidor y </li>
<li>el consumo en el constructor del componente o servicio consumidor.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component, OnInit &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; MovimientosService, Movimiento &#125; <span class="keyword">from</span> <span class="string">'../shared/'</span>;</div><div class="line">@Component(&#123;</div><div class="line">  selector: <span class="string">'movimiento'</span>,</div><div class="line">  templateUrl: <span class="string">'movimiento.component.html'</span>,</div><div class="line">  providers: [MovimientosService] </div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MovimientoComponent</span> </span>&#123;</div><div class="line">  movimiento: Movimiento</div><div class="line">  <span class="keyword">constructor</span>(public movimientosService: MovimientosService) &#123; &#125;</div><div class="line">  guardarMovimiento() &#123;</div><div class="line">    <span class="keyword">this</span>.movimientosService.guardarMovimiento(<span class="keyword">this</span>.movimiento)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/ng2-DI-component-service.jpg" alt="Inyección de servicios en componentes "></p>
<h3 id="Directivas"><a href="#Directivas" class="headerlink" title="Directivas"></a>Directivas</h3><p>Las directivas eran el ADN de AngularJS1. Ahora han mutado en <strong>componentes reutilizables</strong> como elementos en las vistas de otros componentes de rango superior. Pero la idea es la misma, desglosar las plantillas de HTML en bloques con un propósito único. </p>
<p>La sintaxis de las directivas es similar: </p>
<ul>
<li>la definición del servicio decorado como <code>@Injectable()</code> en el componente hijo, </li>
<li>la exportación del hijo y la importación en el padre, </li>
<li>el registro en el array <code>directives:[]</code> del componente padre (o del módulo padre) y </li>
<li>el consumo declarativo en la plantilla de la vista padre.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; MovimientoComponent &#125; <span class="keyword">from</span> <span class="string">'./movimiento'</span>;</div><div class="line">@Component(&#123;</div><div class="line">  selector: <span class="string">'injection-app'</span>,</div><div class="line">  template: <span class="string">'&lt;h1&gt;</span></div><div class="line"><span class="string">              &#123;&#123;titulo&#125;&#125;</span></div><div class="line"><span class="string">            &lt;/h1&gt;</span></div><div class="line"><span class="string">            &lt;movimiento&gt;&lt;/movimiento&gt;'</span>,</div><div class="line">  directives:[MovimientoComponent]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">InjectionAppComponent</span> </span>&#123;</div><div class="line">  titulo = <span class="string">'Inyectores listos!'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/ng2-DI-component-directive.jpg" alt="Inyección de directivas en componentes"></p>
<h2 id="Registro"><a href="#Registro" class="headerlink" title="Registro"></a>Registro</h2><p>La inyección de las dependencias <strong>funciona de manera jerárquica</strong> en AngularJS 2. Cuando un módulo registra una dependencia la pone a disposición de todos sus componentes hijos. Es más, si algún hijo la volviese a registrar se le proveería de otra instancia. </p>
<p>Esta copia puede provocar efectos colaterales indeseados. Para <strong>compartir datos</strong> o ahorrar memoria se recomienda registrar las dependencias lo más arriba posible. Esto siempre sin sacrificar la modularidad o la escalabilidad de aplicaciones que requieran <em>lazy loading</em>.</p>
<blockquote>
<p>Atención a la copia de <em>routeService</em> que se registra por segunda vez. No importa que ya la haya registrado su padre. Otro registro implica otra instancia.</p>
</blockquote>
<p><img src="/images/ng2-Arbol-de-dependencias.jpg" alt="Jerarquía de dependencias en AngularJS"></p>
<p>Para ciertos casos, AngularJS 2 permite modelos de inyección más avanzados. Mediante el uso de <strong>factorías y el registro de cadenas</strong> con los nombres de los servicios facilita la inyección a voluntad o la carga diferida.</p>
<blockquote>
<p>Algunas de estas posibilidades están siendo retocadas durante la actual <em>Release Candidate</em>, y se esperan cambios de cara a las próxima versión estable.</p>
</blockquote>
<p>El viejo principio de <em>divide y vencerás</em> se aplica rotundamente en las aplicaciones Angular 2. Si creas <strong>módulos reutilizables</strong> estarás sentando las bases para crear grandes aplicaciones de negocio con AngularJS.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Introduccion/angular2-di-inyeccion-de-dependencias/" data-id="cj976gtxp002cq4jsf9ypcomi" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-databinding-el-flujo-de-datos-de-angular2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Introduccion/databinding-el-flujo-de-datos-de-angular2/" class="article-date">
  <time datetime="2016-05-25T15:26:32.000Z" itemprop="datePublished">2016-05-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Introduccion/databinding-el-flujo-de-datos-de-angular2/">DataBinding el flujo de datos de Angular2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Código asociado en <a href="https://github.com/AcademiaBinaria/angular2/tree/master/3-databinding" target="_blank" rel="external">angular2/3-databinding/</a> </p>
</blockquote>
<p>El <em>doble binding</em> o enlace vista controlador en ambos sentidos es una de las claves del éxito de AngularJS. Usando la célebre directiva <code>ng-model</code> enganchamos <strong>una propiedad del modelo con un control de la vista</strong>. De manera <em>automágica</em> Angular se suscribe a cambios en el DOM y observa el estado del modelo manteniéndolos en sincronía. </p>
<p>Pero esto tiene un coste en rendimiento que Angular2 supera con un patrón distinto para el control del <strong>flujo de datos</strong> entre la vista y el modelo. Este nuevo paradigma ofrece soluciones para distintos escenarios:</p>
<p><img src="/images/ng2-Flujo-de-datos.jpg" alt="Flujo de datos"></p>
<h2 id="Solo-lectura-modelo-hacia-la-vista"><a href="#Solo-lectura-modelo-hacia-la-vista" class="headerlink" title="Sólo lectura: modelo hacia la vista"></a>Sólo lectura: modelo hacia la vista</h2><h3 id="1-Interpolacion"><a href="#1-Interpolacion" class="headerlink" title="1- Interpolación"></a>1- Interpolación</h3><p>En este primer caso todo nos resultará muy familiar. En efecto la sintáxis de interpolación es la mismoa que en AngularJS 1.x. eso si, en este caso y por defecto, los datos son de sólo lectura y Angular no se preocupa de actualizar la variable.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hola &#123;&#123;nombreDelProgramador&#125;&#125; bienvenido a Angular2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Fecha de nacimiento: &#123;&#123;fechaDeNacimiento | date&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="2-Enlace-a-propiedades"><a href="#2-Enlace-a-propiedades" class="headerlink" title="2- Enlace a propiedades"></a>2- Enlace a propiedades</h3><p>Es la comunicación básica hacia la vista, hacia el usuario. En este caso cualquier atributo de un elemento HTML puede enlazarse al valor de una propiedad encerrándola entre corchetes y asignándole una expresión. <code>[propiedad]=&quot;expresion&quot;</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hola <span class="tag">&lt;<span class="name">input</span> [<span class="attr">value</span>]=<span class="string">"nombreDelProgramador"</span> <span class="attr">readonly</span> &gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span> bienvenido a Angular2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">href</span>]=<span class="string">"url-academia-binaria"</span>&gt;</span>Academia Binaria<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"usuarioAutenticado"</span>&gt;</span>Identifícate<span class="tag">&lt;/<span class="name">div</span>&gt;</span>     </div><div class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!usuarioAutenticado"</span>&gt;</span>Hola &#123;&#123;nombreUsuario&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="Solo-escritura-de-la-vista-hacia-el-modelo"><a href="#Solo-escritura-de-la-vista-hacia-el-modelo" class="headerlink" title="Sólo escritura: de la vista hacia el modelo"></a>Sólo escritura: de la vista hacia el modelo</h2><h3 id="1-Eventos"><a href="#1-Eventos" class="headerlink" title="1- Eventos"></a>1- Eventos</h3><p>La comunicación desde la vista hacia el modelo se realiza mediante eventos. Es una buena práctica llamar a funciones del componente de forma declarativa en la vista.<br>La sintaxis requiere que se nombre el evento entre paréntesis y se le asigne una expresión como valor. <code>(evento)=&quot;expresion&quot;</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> (<span class="attr">keyup</span>)=<span class="string">"onKey($event)"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> #<span class="attr">nombre</span></span></div><div class="line"><span class="tag"> (<span class="attr">keyup.enter</span>)=<span class="string">"propiedad=nombre.value"</span></span></div><div class="line"><span class="tag"> (<span class="attr">blur</span>)=<span class="string">"propiedad=nombre.value"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">lanzarCohete()</span>&gt;</span>Lanzar cohete<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="Lectura-y-escritura-bidireccional"><a href="#Lectura-y-escritura-bidireccional" class="headerlink" title="Lectura y escritura: bidireccional"></a>Lectura y escritura: bidireccional</h2><h3 id="1-Enlace-doble"><a href="#1-Enlace-doble" class="headerlink" title="1- Enlace doble."></a>1- Enlace doble.</h3><p>Este es el caso más común en la edición de formularios. Y es el equivalente al viejo y glorioso <em>doble binding</em>. Es la combinación de los dos anteriores y eso se refleja en la sintaxis. Recordad <code>[]</code> para leer propiedades y <code>()</code> para enviar datos en respuesta a eventos: el resultado es la llamada <em>banana in a box</em> <code>[()]</code>. En este caso se completa con la directiva ngModel y la propiedad enlazada. <code>[(ngModel)]=&quot;propiedad&quot;</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>  [(<span class="attr">ngModel</span>)]=<span class="string">"nombreDelProgramador"</span> &gt;</span></div><div class="line">Hola &#123;&#123;nombreDelProgramador&#125;&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Resumen"><a href="#Resumen" class="headerlink" title="Resumen"></a>Resumen</h2><p>Este es un ejemplo recopilatorio de las capacidades de Angular2 en cuanto a la sintaxis declarativa en las plantillas HTML de los componentes. Recordad este <em>mantra</em> que revisaremos durante la composición de componentes en aplicaciones complejas:</p>
<blockquote>
<p>Los datos fluyen hacia las propiedades de los componentes hijos. Los eventos brotan desde los hijos hacia los padres. Sólo usamos enlace doble en los formularios que así lo requieran.</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--Interpolación de variables definidas en el modelo del componente--&gt;</span></div><div class="line">  &#123;&#123;title&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span>¿Cómo te llamas?<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--Enlace doble (lectura y escritura) entre la vista y el modelo--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> [(<span class="attr">ngModel</span>)]=<span class="string">"aprendiz"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Bienvenido a Angular 2 &#123;&#123; aprendiz &#125;&#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  </div><div class="line">  <span class="comment">&lt;!--Expresiones--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Soy capaz de multiplicar por &#123;&#123;1 * 2&#125;&#125; tus habilidades <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--Eventos--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"visible=true"</span>&gt;</span>Saludar<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--Propiedades--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> [<span class="attr">hidden</span>]=<span class="string">"!visible"</span>&gt;</span>Hola Mundo!!!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure>
<p>En estos ejemplos se han visto propiedades y eventos estándar. Pero todo lo dicho es aplicable a las <strong>propiedades y eventos</strong> especialmente creados para tus componentes.</p>
<p>El objetivo, conseguido, es aumentar el <strong>rendimiento</strong>. Y un efecto colateral es la <strong>simplificación del API</strong> de AngularJS. Desaparecen casi todas las directivas estructurales. Especialmente las famosas <code>ng-click ng-blur</code> y demás directivas asociadas a eventos. Tampoco se necesitan más las directivas de <code>ng-show</code> y <code>ng-hide</code>.</p>
<p>Las únicas directivas estructurales que permanecen son <code>*ngIf</code> <code>*ngSwitch</code> y <code>*ngFor</code>. Pero esas merecen tratamiento aparte.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Introduccion/databinding-el-flujo-de-datos-de-angular2/" data-id="cj976gtxx002iq4jsb51d1ph0" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-componentes-los-bloques-de-construccion-de-angular-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Introduccion/componentes-los-bloques-de-construccion-de-angular-2/" class="article-date">
  <time datetime="2016-05-23T12:07:27.000Z" itemprop="datePublished">2016-05-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Introduccion/componentes-los-bloques-de-construccion-de-angular-2/">Componentes, los bloques de construcción de Angular2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Código asociado en GitHub: <a href="https://github.com/AcademiaBinaria/angular2/tree/master/2-modulos" target="_blank" rel="external">angular2/2-modulos/</a> </p>
</blockquote>
<p>Los componentes son los bloques de construcción de la web moderna. En Angular 2 sustituyen al viejo par Vista-Controlador, el cual ya era opcional en las últimas versiones 1.x Ahora <strong>el componente es el rey</strong>.</p>
<p>Las aplicaciones en Angular2 se desarrollan como <strong>árboles de componentes</strong>. Estos árboles pueden llegar a ser muy frondosos y conviene dirigir su crecimiento agrupándolos en <strong>módulos</strong> para no perderse. Yo procuro estructurarlo en niveles para una mejor comprensión. En cada nivel se crea un módulo y dentro de él se declaran los componentes.</p>
<ul>
<li>1- Nivel <strong>Raíz</strong>:<br>Toda aplicación parte de un componente raíz. Suele recibir el nombre de la aplicación desarrollada y el sufijo <code>App</code> o simplemente <code>App</code>. </li>
<li>2- Nivel <strong>Troncal</strong>:<br>Generalmente dos o tres componentes troncales para la estructura de las páginas. Es común el patrón <em>Navegador-Contenedor</em>, con algún elemento auxiliar para ayudas, mensajes, menús complejos… </li>
<li>3- Nivel de <strong>Ramas</strong>:<br>En este símil, las ramas equivalen a rutas o vistas de la aplicación. En un <em>SPA</em> cada ruta tiene una vista asociada que se carga dentro del componente troncal contenedor </li>
<li>4- Nivel de <strong>Hojas</strong>:<br>Cada una de las vistas está a su vez formada por múltiples componentes de negocio a modo de hojas. </li>
</ul>
<p><img src="/images/ng2-Arbol-de-componentes.jpg" alt="Árbol de componentes en una aplicación Angular 2"></p>
<blockquote>
<p>Con la salvedad de que muchos de estos componentes los puedes reutilizar en distintas vistas.</p>
</blockquote>
<h2 id="Modulos"><a href="#Modulos" class="headerlink" title="Módulos"></a>Módulos</h2><p>Los árboles de componentes pueden ocultarnos fácilmente el bosque de nuestra aplicación. <strong>Los módulos son agrupaciones de componentes.</strong> Nos ayudan a mantener un orden y a encapsular funcionalidad para crear aplicaciones desacopladas con bloques re-utilizables.</p>
<blockquote>
<p>No confundir con los módulos de <em>JavaScript ES6</em> o de T<em>ypeScript</em>. En estos casos se les llama módulos a los ficheros de código que exportan funcionalidad. </p>
</blockquote>
<p>Podemos imaginar un módulo como una fábrica de funcionalidad.</p>
<ol>
<li><strong>Importa</strong> componentes que otros módulos exportan.</li>
<li><strong>Declara</strong> los componentes que el mismo fabrica.  </li>
<li><strong>Exporta</strong> algunos de estos componentes, para que los consuman otros módulos.</li>
</ol>
<h3 id="Anatomia-de-un-Componente"><a href="#Anatomia-de-un-Componente" class="headerlink" title="Anatomía de un Componente"></a>Anatomía de un Componente</h3><p>En el artículo de <a href="http://academia-binaria.com/hola-mundo-en-angular-2/">bienvenida a Angular 2</a> teníamos una aplicación de un sólo módulo con un sólo componente. Y nos sirvió para ver su <strong>estructura</strong>: plantilla, decorador y clase.</p>
<p><img src="/images/ng2Component--1-.jpg" alt="Estructura interna de un componente Angular 2"></p>
<p>La <strong>plantilla</strong> en HTML y la <strong>clase</strong> en JS equivalen a las antiguas vistas y controladores. La <strong>metadata</strong> une ambos mundos y registra el componente para que interacciones con el resto del mundo Angular. </p>
<blockquote>
<p>La comunicación de datos entre la plantilla y el componente se realiza siguiendo un remozado workflow de propiedades y eventos. El nuevo <em>data-binding</em> de Angular2 merece estudio en detalle pues su sintaxis ha cambiado para poder estar a la altura del rendimiento exigido. </p>
</blockquote>
<h3 id="Generacion-de-modulos-y-componentes-con-angular-cli"><a href="#Generacion-de-modulos-y-componentes-con-angular-cli" class="headerlink" title="Generación de módulos y componentes con angular-cli"></a>Generación de módulos y componentes con angular-cli</h3><p>Sobre la base de ese ‘Hola Mundo’ vamos construir una mini aplicación muy sencilla para guardar movimientos económicos. El <em>To Do List</em> de los ingresos y gastos. </p>
<p>Empezaré creando <strong>otro módulo con su componente para ser integrado</strong> en el componente raíz del módulo raíz. Por ahora será un componente de negocio vacío: el componente <code>movimientos</code>. Puedes escribir a mano cada nuevo módulo o componente, pero si usas <a href="https://cli.angular.io/" target="_blank" rel="external">Angular CLI</a> lo tendrás generado con un sólo comando:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">ng g m movimientos</div><div class="line">``` </div><div class="line"></div><div class="line">Verás que se ha creado una carpeta llamada `movimientos` con una estructura que pronto te será muy familiar. Para empezar un archivo para el nuevo módulo, el `movimientos-module.ts`. Después una serie de ficheros para crear su componente principal. Un fichero `movimientos-component.ts` para la clase controladora y el decorador con la *metadata*, y otro fichero `movimientos-component.html` para la plantilla.</div><div class="line"></div><div class="line">Reproduzco ahora su contenido básico. Primero la plantilla HTML</div><div class="line"></div><div class="line">```html</div><div class="line">&lt;p&gt;</div><div class="line">  movimientos works!</div><div class="line">&lt;/p&gt;</div></pre></td></tr></table></figure>
<p>Y ahora la definición del componente en <em>TypeScript</em>. El cual no sabe en qué módulo acabará.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component, OnInit &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="comment">// decoración con metadata para el componente</span></div><div class="line">@Component(&#123;</div><div class="line">  selector: <span class="string">'app-movimientos'</span>, <span class="comment">// ojo al prefijo, por defecto app</span></div><div class="line">  templateUrl: <span class="string">'./movimientos.component.html'</span>, <span class="comment">// podrían ser inline</span></div><div class="line">  styleUrls: [<span class="string">'./movimientos.component.css'</span>] <span class="comment">// podrían ser inline</span></div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MovimientosComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123; &#125;</div><div class="line">  ngOnInit() &#123;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Para que este componente sea conocido ha de estar al menos declarado y exportado en algún módulo. En este caso aparece en el fichero <code>movimientos-module.ts</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; CommonModule &#125; <span class="keyword">from</span> <span class="string">'@angular/common'</span>;</div><div class="line"><span class="comment">/** Importa un componente que declara y que luego exporta */</span></div><div class="line"><span class="keyword">import</span> &#123; MovimientosComponent &#125; <span class="keyword">from</span> <span class="string">'./movimientos.component'</span>;</div><div class="line"></div><div class="line">@NgModule(&#123;</div><div class="line">  imports: [</div><div class="line">    CommonModule</div><div class="line">  ],<span class="comment">// dependencias de otros módulos</span></div><div class="line">  declarations: [</div><div class="line">    MovimientosComponent</div><div class="line">  ],<span class="comment">// Componente que el módulo mismo declara</span></div><div class="line">  exports: [</div><div class="line">    MovimientosComponent</div><div class="line">  ] <span class="comment">// exporta los componentes importables desde otros módulos</span></div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">MovimientosModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<h3 id="Consumo-desde-un-componente-padre"><a href="#Consumo-desde-un-componente-padre" class="headerlink" title="Consumo desde un componente padre"></a>Consumo desde un componente padre</h3><p>El componente <code>movimientos</code> está creado pero nadie lo usa. Para darle utilidad hay que consumirlo. Vamos tocar los ficheros ‘app.module.ts’ y ‘app.component.html’ Son siempre estos tres sencillos pasos:</p>
<ul>
<li><p>1- Importar el módulo que lo exporta</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1 importación del código del módulo funcional</span></div><div class="line"><span class="keyword">import</span> &#123; MovimientosModule &#125; <span class="keyword">from</span> <span class="string">'./movimientos/movimientos.module'</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>2- Registro en el array de importaciones del módulo raíz</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">imports:[..., MovimientosModule] <span class="comment">// 2 registro del modulo importado con todo lo que exporta</span></div><div class="line">...</div></pre></td></tr></table></figure>
</li>
<li><p>3- Uso del componente como un elemento html en la plantilla del padre</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--enlace con propiedades del componente--&gt;</span></div><div class="line">  &#123;&#123;title&#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 3 los componentes personalizados se usan como elementos estándar en html--&gt;</span></div><div class="line"><span class="comment">&lt;!--componente movimientos--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">app-movimientos</span>&gt;</span><span class="tag">&lt;/<span class="name">app-movimientos</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>Esta manera de encapsular componentes unos dentro de otros permite crear <strong>grandes aplicaciones de tamaño empresarial</strong> sin sacrificar la limpieza del código. Cada componente debe diseñarse de forma que resuelva un problema de negocio concreto, por tanto manejable. Y si puede ser <strong>reutilizable</strong> mucho mejor.</p>
<p>La agrupación de componentes en módulos ayuda a mantener la aplicación organizada.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Introduccion/componentes-los-bloques-de-construccion-de-angular-2/" data-id="cj976gty6002uq4jsxd4834w4" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hola-mundo-en-angular-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/academia-binaria-site/Introduccion/hola-mundo-en-angular-2/" class="article-date">
  <time datetime="2016-05-18T14:10:18.000Z" itemprop="datePublished">2016-05-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/academia-binaria-site/Introduccion/hola-mundo-en-angular-2/">Hola Mundo Angular 2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Código asociado en GitHub: <a href="https://github.com/AcademiaBinaria/angular2/tree/master/1-hola-mundo" target="_blank" rel="external">angular2/1-HolaMundo/</a></p>
</blockquote>
<p>Qué lejanos aquellos tiempos dónde un <a href="https://github.com/AcademiaBinaria/HolaAngularJS" target="_blank" rel="external">Hola Mundo en AngularJS</a> se hacía en 2 líneas de código. Ahora necesitaré miles de ficheros y media hora de explicación. Pero el resultado valdrá la pena. Estaremos en la pista de lanzamiento para crear <strong>aplicaciones de nivel empresarial con Angular 2.</strong></p>
<p>Ya he explicado que Angular ha pasado <a href="http://academia-binaria.com/angular2-primeras-impresiones/" target="_blank" rel="external">de framework a plataforma</a>, y que ya no es para aficionados. Grandes desarrollos en equipo requieren <strong>herramientas y procedimientos</strong> a la altura. La primera opción que te recomiendo es <a href="https://cli.angular.io/" target="_blank" rel="external">Angular CLI</a>, un generador de aplicaciones trufado de buenas prácticas y procedimientos. Por raro que te parezca, cualquier otra opción es <em>aún</em> más compleja que la que te muestro.</p>
<h2 id="Preparando-el-entorno"><a href="#Preparando-el-entorno" class="headerlink" title="Preparando el entorno"></a>Preparando el entorno</h2><p>Las herramientas que voy a usar requieren <a href="nodejs.org">NodeJS</a>. Te recomiendo que instales una de sus últimas versiones. Tras la instalación tendrás acceso a <a href="npmjs.com">npm</a> para poder instalar librerías y utilidades como Angular CLI.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g angular-cli</div></pre></td></tr></table></figure>
<p>A partir de ahora en tu linea de comandos podrás usar el programa <code>ng</code> seguido de algún comando como <code>new generate serve lint test e2e build</code>. Usaremos algunos en esta demo.</p>
<h2 id="Creando-aplicaciones-y-componentes"><a href="#Creando-aplicaciones-y-componentes" class="headerlink" title="Creando aplicaciones y componentes"></a>Creando aplicaciones y componentes</h2><p>Escoge un directorio en un disco con espacio libre. No es broma, hasta 300 mb o más para empezar. Tranquilo, en distribución la cosa pinta mucho mejor y Angular es muy ligero. Ahora teclea:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ng new hola-angular-2</div></pre></td></tr></table></figure>
<p>Unos segundos o minutos más tarde… podrás abrir la recién creada carpeta, yo lo hago con <a href="https://code.visualstudio.com/" target="_blank" rel="external">VSCode</a>, y explorar el contenido de sus 3 directorios y miles de ficheros!!!</p>
<p>Después del susto, tranquilidad de nuevo. La mayoría son dependencias de terceros productos, herramientas necesarias para ejecutar aplicación o para alguno de sus procesos de <em>test, lint o distribución</em>. Centrémonos en el directorio <code>src</code> dónde están los fuentes, el código que tendríamos que haber creado nosotros.</p>
<p>De un primer vistazo puede que sólo reconozcas al viejo <code>index.html</code>. No te agobies, por ahora es suficiente. Contendrá algo como esto:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>HolaAngular2<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"icon"</span> <span class="attr">type</span>=<span class="string">"image/x-icon"</span> <span class="attr">href</span>=<span class="string">"favicon.ico"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--Componente raíz de la aplicación--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">app-root</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">app-root</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>De lo que es Angular 2 lo único interesante es el componente <code>&lt;app-root&gt;Loading...&lt;/app-root&gt;</code>. Todo, incluida la aplicación principal, debe ser definido y declarado como un componente. De hecho definiremos las aplicaciones Angular2 como árboles de componentes. Y tdodo árbol debe tener una raíz. Mientras Angular no entre en fucionamiento, el susario verá el mensaje de <em>Loading…</em> después la magia de Angular2 lo sustituirá por el contenido del componente <code>app-root</code> predefinido por el generador. </p>
<h2 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h2><p>Sin entrar en debates de <a href="https://www.youtube.com/watch?v=OpS2R7rbpRg" target="_blank" rel="external">qué lenguaje usar para programar en Angular2</a> te resumo mi posición: </p>
<p>1.- TypeScript te permite anotar tu <strong>JavaScript con tipos</strong>. Esto tiene dos ventajas: <em>intellisense</em> mientras codificas y chequeo de tipos cuando compilas.<br>2.- TypeScript es la <strong>única opción automatizada a día de hoy</strong> con Angular CLI.</p>
<p>Por lo demás no hay porqué alarmarse. <a href="https://www.typescriptlang.org/" target="_blank" rel="external">TypeScript</a> es un <em>superset de JavaScript ES6</em> con unas mejoras evidentes que no tardarás en dominar. Eso si, tienes que aprender <a href="http://es6-features.org/" target="_blank" rel="external">JavaScript ES2015 o ES6</a>.</p>
<p>Sabiendo esto, entra sin miedo en cualquier fichero de extensión <code>.ts</code> y verás que es muy parecido a cualquier <code>.js</code> de la nueva versión. Por ejemplo en el citado <code>main.ts</code> aparecerá algo así:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// importaciones de dependencias TypeScript al estilo ES6</span></div><div class="line"><span class="comment">// primero los básicos para compatibilidad con navegadores</span></div><div class="line"><span class="keyword">import</span> <span class="string">'./polyfills.ts'</span>;</div><div class="line"><span class="comment">// luego cosas de Angular</span></div><div class="line"><span class="keyword">import</span> &#123; platformBrowserDynamic &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser-dynamic'</span>;</div><div class="line"><span class="keyword">import</span> &#123; enableProdMode &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="comment">// después nuestro código, empezando por la configuración</span></div><div class="line"><span class="keyword">import</span> &#123; environment &#125; <span class="keyword">from</span> <span class="string">'./environments/environment'</span>;</div><div class="line"><span class="comment">// y por último la aplicación a leída desde el módulo raíz, llamado app por convenio.</span></div><div class="line"><span class="keyword">import</span> &#123; AppModule &#125; <span class="keyword">from</span> <span class="string">'./app/'</span>;</div><div class="line"></div><div class="line"><span class="comment">// condiciones para ejecutar en modo desarrollo o producción</span></div><div class="line"><span class="keyword">if</span> (environment.production) &#123;</div><div class="line">  enableProdMode();</div><div class="line">&#125;</div><div class="line"><span class="comment">// arranque de la aplicación invocando al módulo raíz</span></div><div class="line">platformBrowserDynamic().bootstrapModule(AppModule);</div></pre></td></tr></table></figure>
<p>Centrándonos en el código que habremos de mantener fíjate en la línea <code>import { AppModule } from &#39;./app/&#39;;</code>. Le indica a <em>WebPack</em> que importe el contenido de la carpeta <code>./app/</code>. Para ello buscará en dicho directorio un archivo <code>index.ts</code>. Ese fichero sirve de índice y contiene las instrucciones para exportar el código interesante del resto de la carpeta. En nuestro caso son el módulo y el componente raíz. </p>
<h2 id="El-modulo-raiz"><a href="#El-modulo-raiz" class="headerlink" title="El módulo raíz"></a>El módulo raíz</h2><p>Las aplicaciones Angular2 están pensadas para crecer. Para ello es fundamental cierto grado de modularidad. EL viejo <code>angular.module</code> ha vuelto en la versión 2. Mira dentro del fichero <code>app.module.ts</code> y verás código similar a este:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// objetos con utilidades comunes del framework</span></div><div class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</div><div class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; FormsModule &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</div><div class="line"><span class="keyword">import</span> &#123; HttpModule &#125; <span class="keyword">from</span> <span class="string">'@angular/http'</span>;</div><div class="line"><span class="comment">// importación del componente raíz, definido en esta misma carpeta</span></div><div class="line"><span class="keyword">import</span> &#123; AppComponent &#125; <span class="keyword">from</span> <span class="string">'./app.component'</span>;</div><div class="line"><span class="comment">// decorador con metadata que define un módulo</span></div><div class="line">@NgModule(&#123;</div><div class="line">  declarations: [</div><div class="line">    AppComponent</div><div class="line">  ], <span class="comment">// cosas declaradas en este módulo</span></div><div class="line">  imports: [</div><div class="line">    BrowserModule,</div><div class="line">    FormsModule,</div><div class="line">    HttpModule</div><div class="line">  ], <span class="comment">// otros módulos que necesitamos para que este funcione</span></div><div class="line">  providers: [] , <span class="comment">// inyección de servicios comunes para la aplicación</span></div><div class="line">  bootstrap: [AppComponent] <span class="comment">// componente raíz para el arranque</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// los módulos son clases contendoras </span></div><div class="line"><span class="comment">// habitualmente con poco o ningún código</span></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<p>Un módulo no es más que una clase contenedora. Cada módulo puede incluir múltiples componentes y servicios. Normalmente un módulo dependerá de otros. El módulo raíz declara un componente especial para el arranque de la aplicación: <em>El componente raíz</em></p>
<h2 id="El-componente-raiz"><a href="#El-componente-raiz" class="headerlink" title="El componente raíz"></a>El componente raíz</h2><p>Buceando a mayor profundidad nos encontramos con el resto del contenido de la carpeta <code>./app/</code>. Son archivos con nombres tipo <code>app.component.*</code> y se usan para definir un componente.</p>
<p>Los <strong>componentes son los bloques de construcción de Angular 2</strong> que representan regiones de la pantalla. Las aplicaciones se definen como árboles de componentes. Nuestra aplicación es un árbol que tiene una raíz, habitualmente llamado <code>app</code> y que es común a cualquier desarrollo.</p>
<p>Cada componente a su vez está formado por tres partes:</p>
<ol>
<li><strong>La vista</strong>: es el código que se renderizará para los usuarios. Esta plantilla estará en un fichero de extensión <code>.html</code>.</li>
<li><strong>La clase controladora</strong>: En ES6 usaremos clases para declarar los controladores que exponen datos y funcionalidad a la vista.</li>
<li><strong>Metadata</strong>: Se declara como un decorador, una función especial de TypeScript, que recibe un objeto de configuración. Esto acompaña al controlador en un fichero de extensión <code>.ts</code></li>
</ol>
<p>Empecemos por este último fichero, el <code>app.component.ts</code>.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="comment">// Función decoradora que registra un componente</span></div><div class="line">@Component(&#123;</div><div class="line">  selector: <span class="string">'app-root'</span>, <span class="comment">// elemento html consumidor</span></div><div class="line">  templateUrl: <span class="string">'./app.component.html'</span>, <span class="comment">// ruta relativa a la vista</span></div><div class="line">  styleUrls: [<span class="string">'./app.component.css'</span>] <span class="comment">// potencialmente múltiples hojas de estilo</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// clase que representa un controlador </span></div><div class="line"><span class="comment">// con su modelo de datos (title ) y métodos de acción (aún no tiene)</span></div><div class="line"><span class="comment">// Esta clase es todo lo que se exporta en este fichero</span></div><div class="line"><span class="comment">// y esto se importará en app.module.ts para ser incorporado el módulo raíz</span></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</div><div class="line">  <span class="comment">// las propiedades de la clase representan el modelo de datos</span></div><div class="line">  <span class="comment">// son accesibles desde la vista</span></div><div class="line">  title = <span class="string">'app works!'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Seguro que la parte más novedosa es <code>@Component({...})</code>. Es el equivalente a los antiguos Objetos de Definición de Directivas. Lo que hace es asociar al controlador una plantilla HTML <code>app.component.html</code> y un selector para ser invocado desde otra vista <code>&lt;app-root&gt;&lt;/app-root&gt;</code>. El resto por ahora puedes obviarlo.</p>
<p>Y hablando de la plantilla, echemos un vistazo a <code>app.component.html</code>. Contendrá algo así:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--Interpolación de variables definidas en el modelo del componente--&gt;</span></div><div class="line">  &#123;&#123; title &#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Estas son cosas que te resultarán muy familiares como la interpolación <code>Hola Mundo Angular 2</code> que permite mostrar el famoso <em>app works!</em>, nueva versión del <em>hola mundo</em>. Ya está, el resto ya es sólo usar este componente en el <code>index.html</code>,<br>Recuerda:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--Componente raíz de la aplicación--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">app-root</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">app-root</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="Angular2-en-accion"><a href="#Angular2-en-accion" class="headerlink" title="Angular2 en acción"></a>Angular2 en acción</h2><p>Para lanzar y probar tu aplicación necesitas otro comando de Angular-CLI. Este comando se ocupa entre otras cosas de todo el proceso necesario para <strong>transformar el código TypeScript en JavaScript</strong> reconocible por el navegador. También crea un mini servidor estático y además refresca el navegador a cada cambio los fuentes. Un salvavidas para un recién llegado a Angular 2. Teclea en tu terminal:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ng serve</div></pre></td></tr></table></figure>
<p>Si todo ha ido bien, no siempre ocurre con estas versiones tan verdes, podrás disfrutar de <strong>tu primera aplicación con Angular 2</strong> en <a href="http://localhost:4200" target="_blank" rel="external">http://localhost:4200</a>  </p>
<blockquote>
<p><a href="https://youtu.be/Y7izsxhPpQY" target="_blank" rel="external">Este vídeo</a> emitido con la colaboración de DesarrolloWeb.com contiene una explicación mas extensa del proceso de trabajo con Angular 2 CLI.</p>
</blockquote>
<div class="flex-video"><br>    <iframe src="https://www.youtube.com/embed/Y7izsxhPpQY"></iframe><br></div>   
      
    </div>
    <footer class="article-footer">
      <a data-url="http://agorabinaria.com/academia-binaria-site/Introduccion/hola-mundo-en-angular-2/" data-id="cj976gtxm0028q4jsl055gt6t" class="article-share-link">Partager</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/academia-binaria-site/page/2/">2</a><a class="page-number" href="/academia-binaria-site/page/3/">3</a><a class="extend next" rel="next" href="/academia-binaria-site/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Catégories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/academia-binaria-site/categories/Avanzado/">Avanzado</a></li><li class="category-list-item"><a class="category-list-link" href="/academia-binaria-site/categories/Introduccion/">Introducción</a></li><li class="category-list-item"><a class="category-list-link" href="/academia-binaria-site/categories/Opinion/">Opinión</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Mot-clés</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/academia-binaria-site/tags/Angular2/">Angular2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/academia-binaria-site/tags/AngularJS/">AngularJS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/academia-binaria-site/tags/BackEnd/">BackEnd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/academia-binaria-site/tags/Bootstrap/">Bootstrap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/academia-binaria-site/tags/FrontEnd/">FrontEnd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/academia-binaria-site/tags/MongoDB/">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/academia-binaria-site/tags/NodeJS/">NodeJS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/academia-binaria-site/tags/TypeScript/">TypeScript</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Nuage de mot-clés</h3>
    <div class="widget tagcloud">
      <a href="/academia-binaria-site/tags/Angular2/" style="font-size: 20px;">Angular2</a> <a href="/academia-binaria-site/tags/AngularJS/" style="font-size: 15px;">AngularJS</a> <a href="/academia-binaria-site/tags/BackEnd/" style="font-size: 10px;">BackEnd</a> <a href="/academia-binaria-site/tags/Bootstrap/" style="font-size: 12.5px;">Bootstrap</a> <a href="/academia-binaria-site/tags/FrontEnd/" style="font-size: 10px;">FrontEnd</a> <a href="/academia-binaria-site/tags/MongoDB/" style="font-size: 12.5px;">MongoDB</a> <a href="/academia-binaria-site/tags/NodeJS/" style="font-size: 17.5px;">NodeJS</a> <a href="/academia-binaria-site/tags/TypeScript/" style="font-size: 10px;">TypeScript</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2017/10/">octubre 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2017/03/">marzo 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2016/09/">septiembre 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2016/06/">junio 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2016/05/">mayo 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2016/04/">abril 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2016/03/">marzo 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2016/01/">enero 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2015/11/">noviembre 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/academia-binaria-site/archives/2015/08/">agosto 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/academia-binaria-site/uncategorized/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/academia-binaria-site/Opinion/typescript-programa-en-el-front-igual-que-en-el-back/">TypeScript, programa en el front igual que en el back</a>
          </li>
        
          <li>
            <a href="/academia-binaria-site/Introduccion/codigo-de-ejemplo-curso-de-angular2/">Código de ejemplo curso de Angular2</a>
          </li>
        
          <li>
            <a href="/academia-binaria-site/Introduccion/formularios-de-datos-en-angular2/">Formularios de datos en Angular2</a>
          </li>
        
          <li>
            <a href="/academia-binaria-site/Introduccion/comunicaciones-http-observables-con-angular2/">Comunicaciones http observables con Angular2</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Alberto Basalo<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/academia-binaria-site/" class="mobile-nav-link">Home</a>
  
    <a href="/academia-binaria-site/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/academia-binaria-site/fancybox/jquery.fancybox.css">
  <script src="/academia-binaria-site/fancybox/jquery.fancybox.pack.js"></script>


<script src="/academia-binaria-site/js/script.js"></script>

  </div>
</body>
</html>